{"version":3,"sources":["../src/index.ts"],"sourcesContent":["import { Socket } from \"socket.io\";\n\nconst express = require(\"express\");\nconst http = require(\"http\");\nconst socketIO = require(\"socket.io\");\n\nconst app = express();\nconst server = http.createServer(app);\nconst io = socketIO(server, {\n  cors: {\n    origin: '*',\n  },\n  autoConnect: false\n});\n\nconst PORT = process.env.PORT || 3001;\n\nio.on(\"connection\", (socket: Socket) => {\n  console.log(`Client ${socket.id} connected`);\n\n  const { playgroundId } = socket.handshake.query;\n\n  socket.join(playgroundId!);\n\n  socket.on(\"update\", (data) => {\n    console.log(data.edges)\n    console.log()\n    socket.broadcast.emit(\"serverUpdate\", { nodes: data.nodes, edges: data.edges });\n  })\n\n  socket.on(\"disconnect\", () => {\n    console.log(`Client ${socket.id} disconnected`);\n    socket.leave(playgroundId as string);\n  });\n});\n\nserver.listen(PORT, () => {\n  console.log(`Server listening on port ${PORT}`);\n});\n"],"mappings":"aAEA,IAAMA,EAAU,QAAQ,SAAS,EAC3BC,EAAO,QAAQ,MAAM,EACrBC,EAAW,QAAQ,WAAW,EAE9BC,EAAMH,EAAQ,EACdI,EAASH,EAAK,aAAaE,CAAG,EAC9BE,EAAKH,EAASE,EAAQ,CAC1B,KAAM,CACJ,OAAQ,GACV,EACA,YAAa,EACf,CAAC,EAEKE,EAAO,QAAQ,IAAI,MAAQ,KAEjCD,EAAG,GAAG,aAAeE,GAAmB,CACtC,QAAQ,IAAI,UAAUA,EAAO,cAAc,EAE3C,GAAM,CAAE,aAAAC,CAAa,EAAID,EAAO,UAAU,MAE1CA,EAAO,KAAKC,CAAa,EAEzBD,EAAO,GAAG,SAAWE,GAAS,CAC5B,QAAQ,IAAIA,EAAK,KAAK,EACtB,QAAQ,IAAI,EACZF,EAAO,UAAU,KAAK,eAAgB,CAAE,MAAOE,EAAK,MAAO,MAAOA,EAAK,KAAM,CAAC,CAChF,CAAC,EAEDF,EAAO,GAAG,aAAc,IAAM,CAC5B,QAAQ,IAAI,UAAUA,EAAO,iBAAiB,EAC9CA,EAAO,MAAMC,CAAsB,CACrC,CAAC,CACH,CAAC,EAEDJ,EAAO,OAAOE,EAAM,IAAM,CACxB,QAAQ,IAAI,4BAA4BA,GAAM,CAChD,CAAC","names":["express","http","socketIO","app","server","io","PORT","socket","playgroundId","data"]}