{"version":3,"sources":["../src/index.ts"],"sourcesContent":["import { Socket } from \"socket.io\";\n\nconst express = require(\"express\");\nconst http = require(\"http\");\nconst socketIO = require(\"socket.io\");\n\nconst app = express();\nconst server = http.createServer(app);\nconst io = socketIO(server, {\n  cors: {\n    origin: '*',\n  },\n  autoConnect: false\n});\n\nconst PORT = process.env.PORT || 3001;\n\nlet tempData: any = {}\nio.on(\"connection\", (socket: Socket) => {\n  console.log(`Client ${socket.id} connected`);\n\n\n  const { playgroundId } = socket.handshake.query;\n  console.log(\"New Playground Id Connection: \", playgroundId)\n\n  socket.join(playgroundId!);\n\n  if (tempData[playgroundId as string]) {\n    console.log(\"Hey\")\n    io.to(socket.id).emit(\"serverUpdate\", {\n      nodes: tempData[playgroundId as string].nodes,\n      edges: tempData[playgroundId as string].edges\n    });\n  }\n\n  socket.on(\"update\", (data) => {\n    tempData = { ...tempData, [playgroundId as string]: data }\n    console.log(\"Received Update From Client: \", playgroundId)\n    socket.broadcast.to(playgroundId!).emit(\"serverUpdate\", { nodes: data.nodes, edges: data.edges });\n  })\n\n  socket.on(\"disconnect\", () => {\n    console.log(`Client ${socket.id} disconnected`);\n    socket.leave(playgroundId as string);\n  });\n});\n\nserver.listen(PORT, () => {\n  console.log(`Server listening on port ${PORT}`);\n});\n"],"mappings":"0bAEA,IAAMA,EAAU,QAAQ,SAAS,EAC3BC,EAAO,QAAQ,MAAM,EACrBC,EAAW,QAAQ,WAAW,EAE9BC,EAAMH,EAAQ,EACdI,EAASH,EAAK,aAAaE,CAAG,EAC9BE,EAAKH,EAASE,EAAQ,CAC1B,KAAM,CACJ,OAAQ,GACV,EACA,YAAa,EACf,CAAC,EAEKE,EAAO,QAAQ,IAAI,MAAQ,KAE7BC,EAAgB,CAAC,EACrBF,EAAG,GAAG,aAAeG,GAAmB,CACtC,QAAQ,IAAI,UAAUA,EAAO,cAAc,EAG3C,GAAM,CAAE,aAAAC,CAAa,EAAID,EAAO,UAAU,MAC1C,QAAQ,IAAI,iCAAkCC,CAAY,EAE1DD,EAAO,KAAKC,CAAa,EAErBF,EAASE,CAAsB,IACjC,QAAQ,IAAI,KAAK,EACjBJ,EAAG,GAAGG,EAAO,EAAE,EAAE,KAAK,eAAgB,CACpC,MAAOD,EAASE,CAAsB,EAAE,MACxC,MAAOF,EAASE,CAAsB,EAAE,KAC1C,CAAC,GAGHD,EAAO,GAAG,SAAWE,GAAS,CAC5BH,EAAWI,EAAAC,EAAA,GAAKL,GAAL,CAAe,CAACE,CAAsB,EAAGC,CAAK,GACzD,QAAQ,IAAI,gCAAiCD,CAAY,EACzDD,EAAO,UAAU,GAAGC,CAAa,EAAE,KAAK,eAAgB,CAAE,MAAOC,EAAK,MAAO,MAAOA,EAAK,KAAM,CAAC,CAClG,CAAC,EAEDF,EAAO,GAAG,aAAc,IAAM,CAC5B,QAAQ,IAAI,UAAUA,EAAO,iBAAiB,EAC9CA,EAAO,MAAMC,CAAsB,CACrC,CAAC,CACH,CAAC,EAEDL,EAAO,OAAOE,EAAM,IAAM,CACxB,QAAQ,IAAI,4BAA4BA,GAAM,CAChD,CAAC","names":["express","http","socketIO","app","server","io","PORT","tempData","socket","playgroundId","data","__spreadProps","__spreadValues"]}